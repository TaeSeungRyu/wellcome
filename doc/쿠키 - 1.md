## 🍪 쿠키 보안 (Cookie Security)

웹 애플리케이션에서 **쿠키(Cookie)** 는 사용자 인증 정보(세션 ID, JWT 등)를 저장하는 데 자주 사용됩니다.
하지만 적절한 보안 설정이 없으면 **XSS, CSRF 등의 공격**에 취약해질 수 있습니다.

아래는 쿠키 보안을 강화하기 위한 주요 속성들입니다.

---

## 1️⃣ HttpOnly

### 🔹 개념

`HttpOnly` 속성이 설정된 쿠키는 **JavaScript에서 접근할 수 없습니다.**

```http
Set-Cookie: sessionId=abc123; HttpOnly
```

### 🔹 목적

* **XSS(Cross-Site Scripting) 공격 방지**
* 악성 스크립트가 `document.cookie`로 쿠키를 탈취하는 것을 차단

### 🔹 동작 방식

* 브라우저는 쿠키를 HTTP 요청에 포함하지만,
* JS 코드에서는 읽거나 수정할 수 없음

### ✅ 권장

인증 관련 쿠키(세션 ID, JWT)는 반드시 `HttpOnly` 설정

---

## 2️⃣ Secure

### 🔹 개념

`Secure` 속성이 설정된 쿠키는 **HTTPS 연결에서만 전송됩니다.**

```http
Set-Cookie: sessionId=abc123; Secure
```

### 🔹 목적

* 네트워크 스니핑(패킷 탈취) 방지
* HTTP(암호화되지 않은 연결)에서 쿠키 전송 차단

### 🔹 동작 방식

* `https://` 요청에서만 쿠키 포함
* `http://` 요청에는 포함되지 않음

### ✅ 권장

운영 환경에서는 반드시 `Secure` 적용
(HTTPS가 기본 전제)

---

## 3️⃣ SameSite

### 🔹 개념

`SameSite`는 **쿠키가 Cross-Site 요청에 포함될지 여부를 제어**합니다.
→ **CSRF(Cross-Site Request Forgery) 방지** 목적

```http
Set-Cookie: sessionId=abc123; SameSite=Strict
```

---

### 🔹 옵션 종류

| 옵션       | 설명                           | 보안 수준    |
| -------- | ---------------------------- | -------- |
| `Strict` | 동일 사이트 요청에만 쿠키 전송            | 🔒 매우 높음 |
| `Lax`    | 기본값, 일부 GET 요청 허용            | 🔐 중간    |
| `None`   | 모든 요청에 쿠키 전송 (반드시 Secure 필요) | ⚠️ 낮음    |

---

### 1️⃣ SameSite=Strict

* 완전히 동일한 사이트에서만 쿠키 전송
* 외부 링크 클릭 시 쿠키 미전송

👉 보안은 가장 강력하지만 UX 영향 가능

---

### 2️⃣ SameSite=Lax (기본값)

* GET 방식의 Top-Level Navigation 요청은 허용
* POST 등 상태 변경 요청은 차단

👉 일반적인 웹 서비스에 적합

---

### 3️⃣ SameSite=None

* 모든 Cross-Site 요청에 쿠키 전송
* **반드시 `Secure`와 함께 사용해야 함**

```http
Set-Cookie: sessionId=abc123; SameSite=None; Secure
```

👉 소셜 로그인, 외부 도메인 연동 시 필요

---

## 🛡 정리

| 속성       | 방어 대상 공격 | 권장 여부           |
| -------- | -------- | --------------- |
| HttpOnly | XSS      | ✅ 필수            |
| Secure   | 네트워크 탈취  | ✅ 필수 (HTTPS 환경) |
| SameSite | CSRF     | ✅ 권장            |

---

## 🚀 실무 권장 설정 예시

```http
Set-Cookie: sessionId=abc123; HttpOnly; Secure; SameSite=Lax
```

또는 외부 연동이 필요한 경우:

```http
Set-Cookie: sessionId=abc123; HttpOnly; Secure; SameSite=None
```

---
