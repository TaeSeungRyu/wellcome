## ✅ 브라우저 렌더링 파이프라인 이론 정리

브라우저는 HTML, CSS, JavaScript를 해석하여
**화면에 픽셀을 그리는 일련의 단계(Rendering Pipeline)**를 거칩니다.

---

## 1️⃣ HTML 파싱 → DOM 생성

### ✅ 개념

- 브라우저가 HTML 문서를 위에서부터 읽으며 **DOM(Document Object Model) 트리**를 생성

### ✅ 특징

- 트리 구조로 구성
- 각 태그는 Node 객체로 변환
- 파싱 도중 `<script>`가 있으면 HTML 파싱이 중단될 수 있음

### 📌 결과

→ **DOM Tree 생성**

```
html
 └── body
      └── div
           └── p
```

---

## 2️⃣ CSS 파싱 → CSSOM 생성

### ✅ 개념

- CSS 파일과 `<style>`을 해석하여 **CSSOM(CSS Object Model)** 생성

### ✅ 특징

- CSS는 위에서 아래로 적용
- 상속/우선순위/Specificity 계산 포함
- CSS는 렌더링 차단 리소스

### 📌 결과

→ 스타일 규칙 트리 생성

---

## 3️⃣ Render Tree 생성

### ✅ 개념

- **DOM + CSSOM을 결합하여 Render Tree 생성**

### ✅ 특징

- 화면에 표시되는 요소만 포함
- `display: none` 요소는 포함되지 않음
- `visibility: hidden`은 포함되지만 보이지 않음

### 📌 목적

→ 실제 화면에 그릴 대상만 구성

---

## 4️⃣ Layout (Reflow)

### ✅ 개념

> 각 요소의 **위치와 크기 계산 단계**

### 계산 요소

- width / height
- margin / padding
- position
- flex / grid
- viewport 크기

### ✅ 특징

- 트리 전체 또는 일부 재계산
- 비용이 큰 작업

### 📌 Reflow 발생 예시

- 요소 크기 변경
- 폰트 변경
- DOM 추가/삭제
- window resize

---

## 5️⃣ Paint (Repaint)

### ✅ 개념

> 계산된 정보를 기반으로 **픽셀을 채우는 단계**

### 처리 내용

- 색상
- 배경
- 그림자
- 테두리
- 텍스트

### ✅ 특징

- 레이아웃 변경 없이 색상만 바뀌면 Repaint만 발생

---

## 6️⃣ Composite (합성 단계)

### ✅ 개념

> 여러 레이어를 GPU가 합성하여 최종 화면 출력

### 특징

- transform
- opacity
- will-change
- position: fixed

이러한 속성은 **레이어 분리(Layer Promotion)** 가능

### 장점

- Layout 없이 GPU 단계에서 처리
- 애니메이션 성능 향상

---

# 📊 전체 흐름 요약

```
HTML → DOM
CSS → CSSOM
DOM + CSSOM → Render Tree
Render Tree → Layout
Layout → Paint
Paint → Composite
```

---

# 🚨 Reflow vs Repaint 차이

| 구분 | Reflow         | Repaint               |
| ---- | -------------- | --------------------- |
| 영향 | 위치/크기 변경 | 색상/스타일 변경      |
| 비용 | 매우 큼        | 중간                  |
| 예시 | width 변경     | background-color 변경 |

---

# ⚡ 성능 최적화 관점

## ✅ 1. Layout 최소화

- DOM 변경 묶어서 처리
- documentFragment 사용
- offsetHeight 같은 강제 동기 Layout 접근 최소화

## ✅ 2. Paint 최소화

- 그림자/그라데이션 과다 사용 지양

## ✅ 3. Composite 활용

- transform / opacity 사용
- will-change 활용
- GPU 가속 유도

---

# 📌 렌더링 파이프라인과 이벤트

- scroll / resize → Layout 유발
- DOM 읽기 + 쓰기 반복 → Layout Thrashing 발생
- debounce / throttle과 함께 사용하면 성능 개선

---

# 🧠 핵심 정리

> 브라우저 렌더링은
> DOM → CSSOM → Render Tree → Layout → Paint → Composite
> 순서로 진행된다.

성능 최적화의 핵심은:

- Reflow 최소화
- Repaint 최소화
- Composite 단계 활용

---
